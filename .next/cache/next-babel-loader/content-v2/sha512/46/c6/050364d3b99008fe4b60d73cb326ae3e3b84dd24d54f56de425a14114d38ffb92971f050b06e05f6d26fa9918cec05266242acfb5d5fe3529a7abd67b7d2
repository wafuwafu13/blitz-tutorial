{"ast":null,"code":"import { SecurePassword } from \"blitz\";\nimport db from \"db\";\nimport { SignupInput } from \"app/auth/validations\";\nexport default async function signup(input, {\n  session\n}) {\n  // This throws an error if input is invalid\n  const {\n    email,\n    password\n  } = SignupInput.parse(input);\n  const hashedPassword = await SecurePassword.hash(password);\n  const user = await db.user.create({\n    data: {\n      email: email.toLowerCase(),\n      hashedPassword,\n      role: \"user\"\n    },\n    select: {\n      id: true,\n      name: true,\n      email: true,\n      role: true\n    }\n  });\n  await session.create({\n    userId: user.id,\n    roles: [user.role]\n  });\n  return user;\n}","map":null,"metadata":{},"sourceType":"module"}