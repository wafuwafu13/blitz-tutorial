{"ast":null,"code":"import { authenticateUser } from \"app/auth/auth-utils\";\nimport { LoginInput } from \"app/auth/validations\";\nexport default async function login(input, {\n  session\n}) {\n  // This throws an error if input is invalid\n  const {\n    email,\n    password\n  } = LoginInput.parse(input); // This throws an error if credentials are invalid\n\n  const user = await authenticateUser(email, password);\n  await session.create({\n    userId: user.id,\n    roles: [user.role]\n  });\n  return user;\n}","map":null,"metadata":{},"sourceType":"module"}